{"ast":null,"code":"import _toConsumableArray from\"/Users/effiphil/Desktop/entertainment-web-app-full/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/effiphil/Desktop/entertainment-web-app-full/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./App.css\";import{useEffect,useState}from\"react\";import{Switch,Route,useHistory}from\"react-router-dom\";import tmdbApi from\"../../utils/tmdbApi\";import mainApi from\"../../utils/mainApi\";import SideNav from\"../SideNav/SideNav\";import Home from\"../Pages/Home/Home\";import Movies from\"../Pages/Movies/Movies\";import Tv from\"../Pages/Tv/Tv\";import Bookmark from\"../Pages/Bookmark/Bookmark\";import Login from\"../Pages/Login/Login\";import Register from\"../Pages/Register/Register\";import ProtectedRoute from\"../ProtectedRoute/ProtectedRoute\";import Modal from\"../Modal/Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),trending=_useState2[0],setTrending=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),recommended=_useState4[0],setRecommended=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),movies=_useState6[0],setMovies=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tv=_useState8[0],setTv=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),searchResult=_useState10[0],setSearchReult=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),bookmarkedMovies=_useState12[0],setBookMarkedMovies=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),bookmarkedTv=_useState14[0],setBookMarkedTv=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),bookmarked=_useState16[0],setBookmarked=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isModalOpen=_useState18[0],setIsModalOpen=_useState18[1];var _useState19=useState({}),_useState20=_slicedToArray(_useState19,2),modalCard=_useState20[0],setModalCard=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),modalTrailer=_useState22[0],setModalTrailer=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),loggedIn=_useState24[0],setLoggedIn=_useState24[1];var _useState25=useState(localStorage.getItem(\"token\")),_useState26=_slicedToArray(_useState25,2),token=_useState26[0],setToken=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),registerationError=_useState28[0],setRegisterationError=_useState28[1];var _useState29=useState(\"\"),_useState30=_slicedToArray(_useState29,2),loginError=_useState30[0],setLoginError=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),isSending=_useState32[0],setIsSending=_useState32[1];var history=useHistory();// checking if user already logged in\nuseEffect(function(){if(token){mainApi.updateToken(token);mainApi.checkToken(token).then(function(){setLoggedIn(true);}).catch(function(err){if(err===400){console.log(\"400 — Token not provided or provided in the wrong format\");}else if(err===401){console.log(\"401 — The provided token is invalid \");}});mainApi.getMedia().then(function(media){var movies=media.filter(function(movie){return movie.media_type!==\"tv\";});var tv=media.filter(function(movie){return movie.media_type!==\"movie\";});setBookmarked(media);setBookMarkedMovies(movies);setBookMarkedTv(tv);}).catch(function(err){console.log(\"there was a problem getting saved articles from the server\",err);});}},[token]);useEffect(function(){tmdbApi.getTrending().then(function(tmdb){setTrending(tmdb.results);}).catch(function(err){console.log(\"there was a problem getting info\",err);});tmdbApi.getRecommended().then(function(tmdb){setRecommended(tmdb.results);}).catch(function(err){console.log(\"there was a problem getting info\",err);});tmdbApi.getMovies(1).then(function(tmdb){setMovies(tmdb.results);}).catch(function(err){console.log(\"there was a problem getting info\",err);});tmdbApi.getTv(1).then(function(tmdb){setTv(tmdb.results);}).catch(function(err){console.log(\"there was a problem getting info\",err);});},[]);var handleSearch=function handleSearch(keyword,type){tmdbApi.search(keyword,type).then(function(tmdbi){setSearchReult(tmdbi.results);}).catch(function(err){console.log(\"there was a problem getting info\",err);});};var handleBookmarkedSearch=function handleBookmarkedSearch(keyword){var result=bookmarked.filter(function(media){return media.title.toLowerCase()===keyword.toLowerCase();});setSearchReult(result);};var handleCardClick=function handleCardClick(id,type){setIsModalOpen(!isModalOpen);tmdbApi.getDetails(id,type).then(function(tmdbi){setModalCard(tmdbi);}).catch(function(err){console.log(\"there was a problem getting info\",err);});tmdbApi.getTrailer(id,type).then(function(tmdb){tmdb.results.forEach(function(trailer){if(trailer.site===\"YouTube\"&&trailer.iso_639_1===\"en\"){setModalTrailer(trailer.key);}});}).catch(function(err){console.log(\"there was a problem getting info\",err);});};var handleShowMore=function handleShowMore(page,type){if(type===\"movie\"){tmdbApi.getMovies(page).then(function(tmdb){setMovies([].concat(_toConsumableArray(movies),_toConsumableArray(tmdb.results)));}).catch(function(err){console.log(\"there was a problem getting info\",err);});}else{tmdbApi.getTv(page).then(function(tmdb){setTv([].concat(_toConsumableArray(tv),_toConsumableArray(tmdb.results)));}).catch(function(err){console.log(\"there was a problem getting info\",err);});}};var handleModalClose=function handleModalClose(){setIsModalOpen(false);};var handleBookmarkClick=function handleBookmarkClick(id,poster,date,type,title){console.log(id,poster,date,type,title);mainApi.saveMedia(id,poster,date,type,title).then(function(media){setBookmarked([media].concat(_toConsumableArray(bookmarked)));if(media.media_type===\"movie\"){setBookMarkedMovies([media].concat(_toConsumableArray(bookmarkedMovies)));}else{setBookMarkedTv([media].concat(_toConsumableArray(bookmarkedTv)));}}).catch(function(err){console.log(\"there was a problem saving media\",err);});};var handleBookmarkRemove=function handleBookmarkRemove(id){mainApi.deleteMedia(id).then(function(media){var newBookmarked=bookmarked.filter(function(c){return c._id!==media._id;});var newBookmarkdedMovies=bookmarkedMovies.filter(function(c){return c._id!==media._id;});var newBookmarkedTv=bookmarkedTv.filter(function(c){return c._id!==media._id;});setBookmarked(newBookmarked);setBookMarkedMovies(newBookmarkdedMovies);setBookMarkedTv(newBookmarkedTv);});};var handleLogin=function handleLogin(email,password){setIsSending(true);mainApi.login(email,password).then(function(data){setLoggedIn(true);setToken(data.token);localStorage.setItem(\"token\",data.token);localStorage.setItem(\"email\",email);history.push(\"/\");}).catch(function(err){if(err===\"Error: 404\")setLoginError(\"User not found\");else if(err===\"Error: 500\"){setLoginError(\"Server error, please try again later\");}}).finally(function(){setIsSending(false);});};var handleRegister=function handleRegister(email,password){mainApi.register(email,password).then(function(){history.push(\"/login\");}).catch(function(err){if(err===\"Error: 409\"){setRegisterationError(\"User already exists\");}else if(err===\"Error: 500\"){setRegisterationError(\"Server error, please try again later\");}});};var handleLogout=function handleLogout(){setLoggedIn(false);setToken(\"\");localStorage.removeItem(\"token\",\"\");localStorage.removeItem(\"email\",\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(SideNav,{loggedIn:loggedIn,onLogout:handleLogout}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",children:/*#__PURE__*/_jsx(Login,{onLogin:handleLogin,isSending:isSending,loginError:loginError})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",children:/*#__PURE__*/_jsx(Register,{onRegister:handleRegister,isSending:isSending,registerationError:registerationError})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",children:/*#__PURE__*/_jsx(Home,{trending:trending,recommended:recommended,onSearch:handleSearch,searchResult:searchResult,onCardClick:handleCardClick,onBookmarkClick:handleBookmarkClick,onRemove:handleBookmarkRemove,bookmarked:bookmarked,loggedIn:loggedIn})}),/*#__PURE__*/_jsx(Route,{path:\"/movies\",children:/*#__PURE__*/_jsx(Movies,{movies:movies,onSearch:handleSearch,searchResult:searchResult,onCardClick:handleCardClick,onShowMore:handleShowMore,onBookmarkClick:handleBookmarkClick,onRemove:handleBookmarkRemove,bookmarked:bookmarked,loggedIn:loggedIn})}),/*#__PURE__*/_jsx(Route,{path:\"/tv\",children:/*#__PURE__*/_jsx(Tv,{tv:tv,onSearch:handleSearch,searchResult:searchResult,onCardClick:handleCardClick,onShowMore:handleShowMore,onBookmarkClick:handleBookmarkClick,onRemove:handleBookmarkRemove,bookmarked:bookmarked,loggedIn:loggedIn})}),/*#__PURE__*/_jsx(ProtectedRoute,{path:\"/saved\",loggedIn:loggedIn,children:/*#__PURE__*/_jsx(Bookmark,{movies:bookmarkedMovies,tv:bookmarkedTv,onSearch:handleBookmarkedSearch,searchResult:searchResult,onCardClick:handleCardClick,onBookmarkClick:handleBookmarkClick,onRemove:handleBookmarkRemove,bookmarked:bookmarked,loggedIn:loggedIn})})]}),/*#__PURE__*/_jsx(Modal,{card:modalCard,trailer:modalTrailer,isModalOpen:isModalOpen,onClose:handleModalClose})]});}export default App;","map":{"version":3,"sources":["/Users/effiphil/Desktop/entertainment-web-app-full/frontend/src/components/App/App.js"],"names":["useEffect","useState","Switch","Route","useHistory","tmdbApi","mainApi","SideNav","Home","Movies","Tv","Bookmark","Login","Register","ProtectedRoute","Modal","App","trending","setTrending","recommended","setRecommended","movies","setMovies","tv","setTv","searchResult","setSearchReult","bookmarkedMovies","setBookMarkedMovies","bookmarkedTv","setBookMarkedTv","bookmarked","setBookmarked","isModalOpen","setIsModalOpen","modalCard","setModalCard","modalTrailer","setModalTrailer","loggedIn","setLoggedIn","localStorage","getItem","token","setToken","registerationError","setRegisterationError","loginError","setLoginError","isSending","setIsSending","history","updateToken","checkToken","then","catch","err","console","log","getMedia","media","filter","movie","media_type","getTrending","tmdb","results","getRecommended","getMovies","getTv","handleSearch","keyword","type","search","tmdbi","handleBookmarkedSearch","result","title","toLowerCase","handleCardClick","id","getDetails","getTrailer","forEach","trailer","site","iso_639_1","key","handleShowMore","page","handleModalClose","handleBookmarkClick","poster","date","saveMedia","handleBookmarkRemove","deleteMedia","newBookmarked","c","_id","newBookmarkdedMovies","newBookmarkedTv","handleLogin","email","password","login","data","setItem","push","finally","handleRegister","register","handleLogout","removeItem"],"mappings":"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","sourcesContent":["import \"./App.css\";\n\nimport { useEffect, useState } from \"react\";\nimport { Switch, Route, useHistory } from \"react-router-dom\";\n\nimport tmdbApi from \"../../utils/tmdbApi\";\nimport mainApi from \"../../utils/mainApi\";\n\nimport SideNav from \"../SideNav/SideNav\";\nimport Home from \"../Pages/Home/Home\";\nimport Movies from \"../Pages/Movies/Movies\";\nimport Tv from \"../Pages/Tv/Tv\";\nimport Bookmark from \"../Pages/Bookmark/Bookmark\";\nimport Login from \"../Pages/Login/Login\";\nimport Register from \"../Pages/Register/Register\";\nimport ProtectedRoute from \"../ProtectedRoute/ProtectedRoute\";\nimport Modal from \"../Modal/Modal\";\n\nfunction App() {\n  const [trending, setTrending] = useState([]);\n  const [recommended, setRecommended] = useState([]);\n  const [movies, setMovies] = useState([]);\n  const [tv, setTv] = useState([]);\n  const [searchResult, setSearchReult] = useState([]);\n  const [bookmarkedMovies, setBookMarkedMovies] = useState([]);\n  const [bookmarkedTv, setBookMarkedTv] = useState([]);\n  const [bookmarked, setBookmarked] = useState([]);\n\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [modalCard, setModalCard] = useState({});\n  const [modalTrailer, setModalTrailer] = useState(\"\");\n\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n\n  const [registerationError, setRegisterationError] = useState(\"\");\n  const [loginError, setLoginError] = useState(\"\");\n  const [isSending, setIsSending] = useState(false);\n\n  const history = useHistory();\n\n  // checking if user already logged in\n  useEffect(() => {\n    if (token) {\n      mainApi.updateToken(token);\n\n      mainApi\n        .checkToken(token)\n        .then(() => {\n          setLoggedIn(true);\n        })\n        .catch((err) => {\n          if (err === 400) {\n            console.log(\n              \"400 — Token not provided or provided in the wrong format\"\n            );\n          } else if (err === 401) {\n            console.log(\"401 — The provided token is invalid \");\n          }\n        });\n\n      mainApi\n        .getMedia()\n        .then((media) => {\n          const movies = media.filter((movie) => movie.media_type !== \"tv\");\n          const tv = media.filter((movie) => movie.media_type !== \"movie\");\n          setBookmarked(media);\n          setBookMarkedMovies(movies);\n          setBookMarkedTv(tv);\n        })\n        .catch((err) => {\n          console.log(\n            \"there was a problem getting saved articles from the server\",\n            err\n          );\n        });\n    }\n  }, [token]);\n\n  useEffect(() => {\n    tmdbApi\n      .getTrending()\n      .then((tmdb) => {\n        setTrending(tmdb.results);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n\n    tmdbApi\n      .getRecommended()\n      .then((tmdb) => {\n        setRecommended(tmdb.results);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n\n    tmdbApi\n      .getMovies(1)\n      .then((tmdb) => {\n        setMovies(tmdb.results);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n\n    tmdbApi\n      .getTv(1)\n      .then((tmdb) => {\n        setTv(tmdb.results);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n  }, []);\n\n  const handleSearch = (keyword, type) => {\n    tmdbApi\n      .search(keyword, type)\n      .then((tmdbi) => {\n        setSearchReult(tmdbi.results);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n  };\n\n  const handleBookmarkedSearch = (keyword) => {\n    const result = bookmarked.filter(\n      (media) => media.title.toLowerCase() === keyword.toLowerCase()\n    );\n    setSearchReult(result);\n  };\n\n  const handleCardClick = (id, type) => {\n    setIsModalOpen(!isModalOpen);\n\n    tmdbApi\n      .getDetails(id, type)\n      .then((tmdbi) => {\n        setModalCard(tmdbi);\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n\n    tmdbApi\n      .getTrailer(id, type)\n      .then((tmdb) => {\n        tmdb.results.forEach((trailer) => {\n          if (trailer.site === \"YouTube\" && trailer.iso_639_1 === \"en\") {\n            setModalTrailer(trailer.key);\n          }\n        });\n      })\n      .catch((err) => {\n        console.log(\"there was a problem getting info\", err);\n      });\n  };\n\n  const handleShowMore = (page, type) => {\n    if (type === \"movie\") {\n      tmdbApi\n        .getMovies(page)\n        .then((tmdb) => {\n          setMovies([...movies, ...tmdb.results]);\n        })\n        .catch((err) => {\n          console.log(\"there was a problem getting info\", err);\n        });\n    } else {\n      tmdbApi\n        .getTv(page)\n        .then((tmdb) => {\n          setTv([...tv, ...tmdb.results]);\n        })\n        .catch((err) => {\n          console.log(\"there was a problem getting info\", err);\n        });\n    }\n  };\n\n  const handleModalClose = () => {\n    setIsModalOpen(false);\n  };\n\n  const handleBookmarkClick = (id, poster, date, type, title) => {\n    console.log(id, poster, date, type, title);\n    mainApi\n      .saveMedia(id, poster, date, type, title)\n      .then((media) => {\n        setBookmarked([media, ...bookmarked]);\n        if (media.media_type === \"movie\") {\n          setBookMarkedMovies([media, ...bookmarkedMovies]);\n        } else {\n          setBookMarkedTv([media, ...bookmarkedTv]);\n        }\n      })\n      .catch((err) => {\n        console.log(\"there was a problem saving media\", err);\n      });\n  };\n\n  const handleBookmarkRemove = (id) => {\n    mainApi.deleteMedia(id).then((media) => {\n      const newBookmarked = bookmarked.filter((c) => c._id !== media._id);\n      const newBookmarkdedMovies = bookmarkedMovies.filter(\n        (c) => c._id !== media._id\n      );\n      const newBookmarkedTv = bookmarkedTv.filter((c) => c._id !== media._id);\n\n      setBookmarked(newBookmarked);\n      setBookMarkedMovies(newBookmarkdedMovies);\n      setBookMarkedTv(newBookmarkedTv);\n    });\n  };\n\n  const handleLogin = (email, password) => {\n    setIsSending(true);\n    mainApi\n      .login(email, password)\n      .then((data) => {\n        setLoggedIn(true);\n        setToken(data.token);\n        localStorage.setItem(\"token\", data.token);\n        localStorage.setItem(\"email\", email);\n        history.push(\"/\");\n      })\n      .catch((err) => {\n        if (err === \"Error: 404\") setLoginError(\"User not found\");\n        else if (err === \"Error: 500\") {\n          setLoginError(\"Server error, please try again later\");\n        }\n      })\n      .finally(() => {\n        setIsSending(false);\n      });\n  };\n\n  const handleRegister = (email, password) => {\n    mainApi\n      .register(email, password)\n      .then(() => {\n        history.push(\"/login\");\n      })\n      .catch((err) => {\n        if (err === \"Error: 409\") {\n          setRegisterationError(\"User already exists\");\n        } else if (err === \"Error: 500\") {\n          setRegisterationError(\"Server error, please try again later\");\n        }\n      });\n  };\n\n  const handleLogout = () => {\n    setLoggedIn(false);\n    setToken(\"\");\n    localStorage.removeItem(\"token\", \"\");\n    localStorage.removeItem(\"email\", \"\");\n  };\n\n  return (\n    <div className=\"App\">\n      <SideNav loggedIn={loggedIn} onLogout={handleLogout} />\n\n      <Switch>\n        <Route path=\"/login\">\n          <Login\n            onLogin={handleLogin}\n            isSending={isSending}\n            loginError={loginError}\n          />\n        </Route>\n\n        <Route path=\"/signup\">\n          <Register\n            onRegister={handleRegister}\n            isSending={isSending}\n            registerationError={registerationError}\n          />\n        </Route>\n\n        <Route exact path=\"/\">\n          <Home\n            trending={trending}\n            recommended={recommended}\n            onSearch={handleSearch}\n            searchResult={searchResult}\n            onCardClick={handleCardClick}\n            onBookmarkClick={handleBookmarkClick}\n            onRemove={handleBookmarkRemove}\n            bookmarked={bookmarked}\n            loggedIn={loggedIn}\n          />\n        </Route>\n\n        <Route path=\"/movies\">\n          <Movies\n            movies={movies}\n            onSearch={handleSearch}\n            searchResult={searchResult}\n            onCardClick={handleCardClick}\n            onShowMore={handleShowMore}\n            onBookmarkClick={handleBookmarkClick}\n            onRemove={handleBookmarkRemove}\n            bookmarked={bookmarked}\n            loggedIn={loggedIn}\n          />\n        </Route>\n\n        <Route path=\"/tv\">\n          <Tv\n            tv={tv}\n            onSearch={handleSearch}\n            searchResult={searchResult}\n            onCardClick={handleCardClick}\n            onShowMore={handleShowMore}\n            onBookmarkClick={handleBookmarkClick}\n            onRemove={handleBookmarkRemove}\n            bookmarked={bookmarked}\n            loggedIn={loggedIn}\n          />\n        </Route>\n\n        <ProtectedRoute path=\"/saved\" loggedIn={loggedIn}>\n          <Bookmark\n            movies={bookmarkedMovies}\n            tv={bookmarkedTv}\n            onSearch={handleBookmarkedSearch}\n            searchResult={searchResult}\n            onCardClick={handleCardClick}\n            onBookmarkClick={handleBookmarkClick}\n            onRemove={handleBookmarkRemove}\n            bookmarked={bookmarked}\n            loggedIn={loggedIn}\n          />\n        </ProtectedRoute>\n      </Switch>\n\n      <Modal\n        card={modalCard}\n        trailer={modalTrailer}\n        isModalOpen={isModalOpen}\n        onClose={handleModalClose}\n      />\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}